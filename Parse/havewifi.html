<!DOCTYPE html>  
<html>  
	<head>  
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>  
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>  	
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		
		<!-- CSS -->
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
		<link type="text/css" rel="stylesheet" href="css/styles.css" media="screen" />
		
		<style>
			::-webkit-input-placeholder {
				color: #538DB9;
		}
		</style>
		<!-- Scripts -->
		<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
		<script src="http://www.parsecdn.com/js/parse-1.1.5.min.js"></script>
		<script type="text/javascript"
			src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBVYmtKrniJdpYFLa4-QMXaWYemedvw1bA&sensor=true">
		</script>
		<script type="text/javascript">  
		
			var geocoder;
			
			function initialize() {  
				geocoder = new google.maps.Geocoder();  
				document.getElementById("Name").focus();
			}  
		  
			function mainFunction() {
			
				var point;
			
				//Getting the rest of the information from the form
				var name=document.getElementById("Name").value;
				var cost=(document.getElementById("Cost").value)*1;
				var bandwidth=(document.getElementById("Bandwidth").value)*1;
				var email=(document.getElementById("Email").value);
				var address=(document.getElementById("Address").value);
				var phone=(document.getElementById("Phone").value);
				
				/* Input Validation */
				/*if(name==""||cost==""||email==""||address=="")
					{
						alert("Please fill out all of the required information.");
						document.getElementById("Name").focus();
						return;
					}		
				if(!verifyEmail(email))
				{
					alert("Please enter a valid email address.");
					return;
				}*/
						
				geocoder.geocode( { 'address': address}, function(results, status) {  
				if (status == google.maps.GeocoderStatus.OK) {
				
					Parse.initialize("w2QBbAohqDJLi4kE7tMP5oaca09vw63UgCo8OfMv", "EOfmgHdudoXYhuRtdjN7dpEPMg7CqE03YTzBcZRx");
				
					var Hotspots = Parse.Object.extend("Hotspots");
					var hotspots=new Hotspots();
		
					var Users = Parse.Object.extend("Users");
					var users=new Users();

					point = new Parse.GeoPoint({latitude:results[0].geometry.location.lat(),longitude:results[0].geometry.location.lng()});

					hotspots.set("Name",name);
					hotspots.set("Cost",cost);
					hotspots.set("Location",point);
					hotspots.set("Address",address);
					hotspots.set("Bandwidth",bandwidth);

					users.set("Phone",phone);
					users.set("Email",email);

					users.save(null,{
						success: function(users){
						alert("User data stored successfully on Wi-Find");
					},
					error: function(users,error){
						alert("Failed to save user data on Wi-Find");
					}
					});
					
					hotspots.save(null,{
						success: function(hotspots){
						alert("Hotspot data stored successfully on Wi-Find");
					},
					error: function(hotspots,error){
						alert("Failed to save Hotspot information on Wi-Find");
					}
					});

					} else {  
						alert("Geocode was not successful for the following reason: " + status);  
					}			
				});
			}  
			
			function verifyEmail(email)
			{
				var reg = /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;
				email_Flag = reg.test(email);
				return email_Flag;
			}
			
			function showhidefield()
				  {
					  if (document.getElementById("checkbox-1").checked)
				    {
				      document.getElementById("Address").style.display = "none";
				    }
				    else
				    {
 				      document.getElementById("Address").style.display = "block";
 				    }
				  }

		</script>  
	</head>  
	<body onload="initialize()"> 
		<div data-role="page" data-theme="b" id="page1" data-theme="a" >
			<div data-role="header" data-theme="a" style="height:35px;">
				<h1>Share Wi-Fi</h1>
			</div><!-- /header -->
			
			<div data-role="content" id="contentMain" name="contentMain">	
				<form id="form1">
				
					<h4>Tell us about your hotspot.</h4>
				
					<div id="div1" data-role="fieldcontain">
						<input id="Name" name="Name" type="text" value="" placeholder="Name (required)"/><br><br>
						<input id="Cost" name="Cost" type="text" placeholder="Asking Price (required)"/><br><br>
						<input id="Bandwidth" name="Bandwidth" type="text" placeholder="Bandwidth"/>
					</div>
					
					<div id="div1" data-role="fieldcontain">
						<input type="checkbox" name="checkbox-1" id="checkbox-1" class="custom" onclick="showhidefield()"/>
						<label for="checkbox-1">Use my current location!</label>						
						<input id="Address" name="Address" type="text" value="" placeholder="Enter your street and zipcode (required)" style="display:block" />
					</div>
				
					<h4>How can buyers reach you?</h4>
					<div id="div1" data-role="fieldcontain">	
						<input id="Email" name="Email" type="text" value="" placeholder="Email (required)"/>
						<input id="Phone" name="Phone" type="text" value="" placeholder="Phone Number (optional)"/>
					</div>
			    	
					<input type="button" value="Submit" onclick="mainFunction()" data-theme="a"/>  
	
			    </form>
			</div>
			
			<div class="footer" data-role="footer" data-theme="a" >
			&copy; 2012 Wi-Find Alpha.
			</div><!-- /footer -->
		</div>
	</body>
</html>