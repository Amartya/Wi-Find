<!DOCTYPE html>  
<html>  
	<head>  
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>  
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>  	
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		
		<!-- CSS -->
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
		
		<!-- Scripts -->
		<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
		<script src="http://www.parsecdn.com/js/parse-1.1.5.min.js"></script>
		<script type="text/javascript"
			src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBVYmtKrniJdpYFLa4-QMXaWYemedvw1bA&sensor=true">
		</script>
		<script type="text/javascript">  
			
			var geocoder;
			
			function initialize() {  
				geocoder = new google.maps.Geocoder();  
			}  
		  
			function mainFunction() {
			
				Parse.initialize("w2QBbAohqDJLi4kE7tMP5oaca09vw63UgCo8OfMv", "EOfmgHdudoXYhuRtdjN7dpEPMg7CqE03YTzBcZRx");
				
				var Hotspots = Parse.Object.extend("Hotspots");
				var hotspots=new Hotspots();
				var point;
				var x;
				var y;
			
				var name=document.getElementById("Name").value;
				var cost=(document.getElementById("Cost").value)*1;
				var bandwidth=(document.getElementById("Bandwidth").value)*1;
				var email=(document.getElementById("Email").value);
				var address=(document.getElementById("Address").value);
				
				/* Input Validation */
				/*if(name==""||cost==""||email==""||address==""||zipcode=="")
					{
						alert("Please fill out all of the required information.");
						return;
					}		
				if(!verfifyEmail(email))
				{
					alert("Please enter a valid email address.");
					return;
				}*/
						
				geocoder.geocode( { 'address': address}, function(results, status) {  
				if (status == google.maps.GeocoderStatus.OK) {
					point = new Parse.GeoPoint({latitude:results[0].geometry.location.lat(),longitude:results[0].geometry.location.lng()});

					alert(results[0].geometry.location.lat().toString());
 					alert(results[0].geometry.location.lng().toString());
 					
 					x=results[0].geometry.location.lat().toString();
 					y=results[0].geometry.location.lng().toString();

				} else {  
					alert("Geocode was not successful for the following reason: " + status);  
				}  
				}); 

				//Getting the rest of the information from the form
				var name=document.getElementById("Name").value;
				var cost=(document.getElementById("Cost").value)*1;
				var bandwidth=(document.getElementById("Bandwidth").value)*1;
				var email=(document.getElementById("Email").value);
				var address=(document.getElementById("Address").value);
				
			 /* function codeAddress() {  
			    var address = document.getElementById("address").value;  
			    geocoder.geocode( { 'address': address}, function(results, status) {  
			      if (status == google.maps.GeocoderStatus.OK) {  
			        alert(results[0].geometry.location);  
			      } else {  
			        alert("Geocode was not successful for the following reason: " + status);  
			      }  
			    });  
			  }*/
			  
				//Store data in parse
	        	Parse.initialize("w2QBbAohqDJLi4kE7tMP5oaca09vw63UgCo8OfMv", "EOfmgHdudoXYhuRtdjN7dpEPMg7CqE03YTzBcZRx");
			
				var Hotspots = Parse.Object.extend("Hotspots");
				var hotspots=new Hotspots();
				hotspots.set("Name",name);
				hotspots.set("Cost",cost);
				hotspots.set("Location",point);
				hotspots.set("Address",address);
				hotspots.set("Bandwidth",bandwidth);
				hotspots.set("Test1",x);
				hotspots.set("Test2",y);
				
				hotspots.save(null,{
					success: function(hotspots){
						alert("Data stored successfully on Wi-Find");
					},
					error: function(hotspots,error){
						alert("Failed to save information on Wi-Find");
					}
				});
			}  
			
			function verifyEmail(email)
			{
				var reg = /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;
				email_Flag = reg.test(email);
				return email_Flag;
			}

		</script>  
	</head>  
	<body onload="initialize()"> 
		<div data-role="page" data-theme="b" id="page1" data-theme="a" >
			<div data-role="header" data-theme="a" style="height:35px;">
				<h1>Share Wi-Fi</h1>
			</div><!-- /header -->
			
			<div data-role="content" id="contentMain" name="contentMain">	
				<form id="form1">
					<div id="div1" data-role="fieldcontain">
						<label for="Name">Name*</label>		
						<input id="Name" name="Name" type="text" value=""/>
					</div>
					

					<div id="div2" data-role="fieldcontain">
						<label for="Cost" >Cost*</label>		
						<input id="Cost" name="Cost" type="text" />
					</div>
					
					<div id="div1" data-role="fieldcontain">
						<label for="Address">Street Address*</label>		
						<input id="Address" name="Address" type="text" value=""/>
					</div>
					
					<div id="div1" data-role="fieldcontain">
						<label for="Email">Email*</label>		
						<input id="Email" name="Email" type="text" value=""/>
					</div>
					
					<div id="div4" data-role="fieldcontain">
						<label for="Bandwidth">Bandwidth</label>		
						<input id="Bandwidth" name="Bandwidth" type="text" />
					</div>
			    	
					<input type="button" value="Submit" onclick="mainFunction()" data-theme="a"/>  
					
			    </form>
			</div>
			
			<div class="footer" data-role="footer" data-theme="a" >
			&copy; 2012 Wi-Find Alpha.
			</div><!-- /footer -->
		</div>
	</body>
</html>